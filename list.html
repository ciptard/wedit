<p>[#path#]</p>
<hr>
<div>[#list#]</div>
<hr>
<div id="buttons">
<input type="button" value="&uarr; [#Upload#]&hellip; (todo)"/>
<input type="button" value="&darr; [#Download#] (todo)"/>
<input type="button" id="btn_create" value="[#Create#]&hellip;" onclick="createFile();"/>
<input type="button" value="[#Change#]&hellip;" onclick="changeFile();"/>
<input type="button" value="&empty; [#Delete#] (todo)"/>
</div>

<div style="display: none;">
<form id="cancel" method="post">
</form>
</div>

<script type="text/javascript" language="javascript">
function enableButtons(enable)
{
  if (enable) {
    $('[input[type=button]').removeAttr('disabled');
  }
  else {
    $('[input[type=button]').attr('disabled', 'true');
  }
}

//Создать файл
function createFile()
{
  enableButtons(false);
  $('#files').append('<tr id="files_create_row">'+
  	'<td></td>'+
  	'<td><input id="_newname" type="string" size=15 value="new.txt"/></td>'+
  	'<td><select id="_newtype"><option>Directory</option><option selected>File</option></select></td>'+
  	'<td></td>'+
  	'<td></td>'+
  	'<td></td>'+
  	'<td></td>'+
  	'<td><form id="create" method="post">'+
  	  '<input id="operation" name="operation" type="hidden" value="create"/>'+
  	  '<input id="newname" name="newname" type="hidden"/>'+
  	  '<input id="newtype" name="newtype" type="hidden"/>'+
  	  '<input id="newok" type="button" value="'+t('OK')+'" onclick="sendCreateFile();"/>'+
  	  '<input id="newcancel" type="button" value="'+t('Cancel')+'" onclick="cancelCreateFile();"/>'+
  	'</form></td>'+
  	'</tr>');
}

function sendCreateFile()
{
  $('#newname').val($('#_newname').val());
  $('#newtype').val($('#_newtype').val());
  $('#create').submit();
}

function cancelCreateFile()
{
  enableButtons(true);
  $('#files_create_row').remove();
}

function changeFile()
{
  if ($('input:checked[id^=f_*]').length != 1) {
    alert(t('You must select only one file for this operation'));
    return;
  }
  else {
    enableButtons(false);
    var row = $('input:checked[id^=f_*]').parent().parent();
    var old_filename = row.children('td:eq(1)').children('a').html();
    row.children('td:eq(1)').html(
      '<input type="text" id="_changename" size=15 value="'+old_filename+'"/>'
    );
    //row.children('td:eq(3)').html(
    //  '<input type="text" id="_chengeaccess" size=5 value="'+row.children('td:eq(3)').html()+'"/>'
  	//);
  	row.children('td:eq(7)').html(
      '<form id="change" method="post">'+
        '<input id="operation" name="operation" type="hidden" value="change"/>'+
        '<input id="oldname" name="oldname" type="hidden" value="'+old_filename+'"/>'+
        '<input id="changename" name="changename" type="hidden"/>'+
        //'<input id="chengeaccess" name="chengeaccess" type="hidden"/>'+
        '<input id="change_ok" type="button" value="'+t('OK')+'" onclick="sendChangeFile();"/>'+
        '<input id="change_cancel" type="button" value="'+t('Cancel')+'" onclick="cancelChangeFile();"/>'+
      '</form>'
    );
  }
}

function sendChangeFile()
{
  $('#changename').val($('#_changename').val());
  //$('#chengeaccess').val($('#_chengeaccess').val());
  $('#change').submit();
}

function cancelChangeFile()
{
  $('#cancel').submit();
}

</script>